# 2D Spectral Element Method (SEM) Poisson Solver: P-Convergence Analysis

## Description

This repository contains a high-order **Spectral Element Method (SEM)** solver for the 2D Poisson equation on quadrilateral meshes. The primary purpose of this script is to perform a **Method of Manufactured Solutions (MMS)** study to verify the exponential convergence (p-convergence) characteristic of spectral methods.

Unlike standard Finite Element Methods (FEM) that increase resolution by refining the mesh (h-refinement), this code demonstrates how increasing the polynomial order  within elements leads to a rapid, exponential decay in  error for smooth solutions.

## Mathematical Problem

The script solves the Poisson equation:


The solver is verified using a manufactured sinusoidal solution:

* **Exact Solution:** 
* **Source Term:** 
* **Domain:** Defined by the input mesh files (typically a unit square).
* **Boundary Conditions:** Homogeneous Dirichlet boundaries.

## Dependent Files

To execute this solver, the following files and utilities are required:

1. **Mesh Files:** A series of mesh files named according to the `base` variable (e.g., `squaretest1.m`, `squaretest2.m`, up to `squaretest10.m`). These should define the nodal coordinates and element connectivity for the corresponding polynomial degrees.
2. **meshreader.m:** A utility function to parse the GMSH-style mesh files into a MATLAB-accessible structure.
3. **Barycentric Utilities:** The code relies on barycentric interpolation functions (`bary_weights`, `bary_eval_matrix`) included in the script to handle high-order Lagrangian basis functions robustly.

## Technical Features

* **Tensor-Product Basis:** Utilizes a tensor-product formulation for quadrilateral elements, allowing for efficient high-order operations.
* **Barycentric Lagrange Interpolation:** Implements the barycentric form of the Lagrange interpolant for improved numerical stability at high polynomial orders (up to ).
* **Robust Tensor Alignment:** Includes a sophisticated alignment check (`perm_g2t`) to ensure that GMSH-ordered nodes are correctly mapped to the internal tensor-product quadrature grid.
* **Convergence Metrics:**
* **Local Alpha:** Calculates the pairwise error reduction rate between  and .
* **Average Alpha:** Calculates the global exponential decay rate.
* **Asymptotic Fit:** Performs a linear fit on the log-error curve to determine the overall convergence rate.



## Analysis and Output

The script produces two primary diagnostic plots:

1. **L2 Error vs. P (Semilogy):** A standard plot showing the linear-log relationship characteristic of exponential convergence.
2. **Alpha vs. P:** A scaling graph showing the stability and magnitude of the exponential decay rate.

## How to Use

1. Ensure the required mesh files (`squaretest*.m`) are in the working directory.
2. Set the `p_list` variable to the range of polynomial degrees you wish to test.
3. Run `mms_p_convergence_alpha.m`.
4. The console will print the  error and the log-error for each order, followed by the asymptotic convergence rate.

---

**Next Step:** Since this script focuses on convergence analysis, would you like me to create a "Theory" document for your repo that explains the difference between **h-refinement** and **p-refinement** using the data generated by this code?
